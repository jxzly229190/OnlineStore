/*
* Kendo UI Complete v2013.2.918 (http://kendoui.com)
* Copyright 2013 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-complete-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
!function(define){return define(["./kendo.data.min","./kendo.editable.min","./kendo.selectable.min"],function(){!function(e,t){var n=window.kendo,a="change",r="cancel",i="dataBound",l="dataBinding",o=n.ui.Widget,d=n.keys,s=">*",c="progress",u="error",m="k-state-focused",f="k-state-selected",p="k-edit-item",g="string",v="edit",b="remove",h="save",_="click",S=".kendoListView",E=e.proxy,w=n._activeElement,y=n.ui.progress,k=n.data.DataSource,T=o.extend({init:function(t,a){var r=this;a=e.isArray(a)?{dataSource:a}:a,o.fn.init.call(r,t,a),a=r.options,r.wrapper=t=r.element,t[0].id&&(r._itemId=t[0].id+"_lv_active"),r._element(),r._dataSource(),r.template=n.template(a.template||""),r.altTemplate=n.template(a.altTemplate||a.template),r.editTemplate=n.template(a.editTemplate||""),r._navigatable(),r._selectable(),r._pageable(),r._crudHandlers(),r.options.autoBind&&r.dataSource.fetch(),n.notify(r)},events:[a,r,l,i,v,b,h],options:{name:"ListView",autoBind:!0,selectable:!1,navigatable:!1,template:"",altTemplate:"",editTemplate:""},_item:function(e){return this.element.children()[e]()},items:function(){return this.element.children()},setDataSource:function(e){this.options.dataSource=e,this._dataSource(),this.options.autoBind&&e.fetch()},_unbindDataSource:function(){var e=this;e.dataSource.unbind(a,e._refreshHandler).unbind(c,e._progressHandler).unbind(u,e._errorHandler)},_dataSource:function(){var e=this;e.dataSource&&e._refreshHandler?e._unbindDataSource():(e._refreshHandler=E(e.refresh,e),e._progressHandler=E(e._progress,e),e._errorHandler=E(e._error,e)),e.dataSource=k.create(e.options.dataSource).bind(a,e._refreshHandler).bind(c,e._progressHandler).bind(u,e._errorHandler)},_progress:function(){y(this.element,!0)},_error:function(){y(this.element,!1)},_element:function(){this.element.addClass("k-widget k-listview").attr("role","listbox")},refresh:function(e){var a,r,o,d,s,c=this,u=c.dataSource.view(),m="",f=c.template,p=c.altTemplate,g=w();if(e=e||{},"itemchange"===e.action)return c._hasBindingTarget()||c.editable||(a=e.items[0],o=c.items().filter("["+n.attr("uid")+"="+a.uid+"]"),o.length>0&&(d=o.index(),o.replaceWith(f(a)),o=c.items().eq(d),o.attr(n.attr("uid"),a.uid),c.trigger("itemChange",{item:o,data:a}))),t;if(!c.trigger(l,{action:e.action||"rebind",items:e.items,index:e.index})){for(c._destroyEditable(),d=0,s=u.length;s>d;d++)m+=d%2?p(u[d]):f(u[d]);for(c.element.html(m),r=c.items(),d=0,s=u.length;s>d;d++)r.eq(d).attr(n.attr("uid"),u[d].uid).attr("role","option").attr("aria-selected","false");c.element[0]===g&&c.options.navigatable&&c.current(r.eq(0)),c.trigger(i)}},_pageable:function(){var t,a,r=this,i=r.options.pageable;e.isPlainObject(i)&&(a=i.pagerId,t=e.extend({},i,{dataSource:r.dataSource,pagerId:null}),r.pager=new n.ui.Pager(e("#"+a),t))},_selectable:function(){var e,r,i=this,l=i.options.selectable,o=i.options.navigatable;l&&(e=typeof l===g&&l.toLowerCase().indexOf("multiple")>-1,e&&i.element.attr("aria-multiselectable",!0),i.selectable=new n.ui.Selectable(i.element,{aria:!0,multiple:e,filter:s,change:function(){i.trigger(a)}}),o&&i.element.on("keydown"+S,function(n){if(n.keyCode===d.SPACEBAR){if(r=i.current(),n.target==n.currentTarget&&n.preventDefault(),e)if(n.ctrlKey){if(r&&r.hasClass(f))return r.removeClass(f),t}else i.selectable.clear();else i.selectable.clear();i.selectable.value(r)}}))},current:function(e){var n=this,a=n.element,r=n._current,i=n._itemId;return e===t?r:(r&&r[0]&&(r[0].id===i&&r.removeAttr("id"),r.removeClass(m),a.removeAttr("aria-activedescendant")),e&&e[0]&&(i=e[0].id||i,n._scrollTo(e[0]),a.attr("aria-activedescendant",i),e.addClass(m).attr("id",i)),n._current=e,t)},_scrollTo:function(t){var n,a,r=this,i=!1,l="scroll";"auto"==r.wrapper.css("overflow")||r.wrapper.css("overflow")==l?n=r.wrapper[0]:(n=window,i=!0),a=function(a,r){var o=i?e(t).offset()[a.toLowerCase()]:t["offset"+a],d=t["client"+r],s=e(n)[l+a](),c=e(n)[r.toLowerCase()]();o+d>s+c?e(n)[l+a](o+d-c):s>o&&e(n)[l+a](o)},a("Top","Height"),a("Left","Width")},_navigatable:function(){var t=this,a=t.options.navigatable,r=t.element,i=function(n){t.current(e(n.currentTarget)),e(n.target).is(":button,a,:input,a>.k-icon,textarea")||r.focus()};a&&(t._tabindex(),r.on("focus"+S,function(){var e=t._current;e&&e.is(":visible")||(e=t._item("first")),t.current(e)}).on("focusout"+S,function(){t._current&&t._current.removeClass(m)}).on("keydown"+S,function(a){var i,l,o=a.keyCode,s=t.current(),c=e(a.target),u=!c.is(":button,textarea,a,a>.t-icon,input"),m=c.is(":text"),f=n.preventDefault,g=r.find("."+p),v=w();if(!(!u&&!m&&d.ESC!=o||m&&d.ESC!=o&&d.ENTER!=o))if(d.UP===o||d.LEFT===o)s&&(s=s.prev()),t.current(s&&s[0]?s:t._item("last")),f(a);else if(d.DOWN===o||d.RIGHT===o)s&&(s=s.next()),t.current(s&&s[0]?s:t._item("first")),f(a);else if(d.PAGEUP===o)t.current(null),t.dataSource.page(t.dataSource.page()-1),f(a);else if(d.PAGEDOWN===o)t.current(null),t.dataSource.page(t.dataSource.page()+1),f(a);else if(d.HOME===o)t.current(t._item("first")),f(a);else if(d.END===o)t.current(t._item("last")),f(a);else if(d.ENTER===o)0!==g.length&&(u||m)?(i=t.items().index(g),v&&v.blur(),t.save(),l=function(){t.element.trigger("focus"),t.current(t.items().eq(i))},t.one("dataBound",l)):""!==t.options.editTemplate&&t.edit(s);else if(d.ESC===o){if(g=r.find("."+p),0===g.length)return;i=t.items().index(g),t.cancel(),t.element.trigger("focus"),t.current(t.items().eq(i))}}),r.on("mousedown"+S+" touchstart"+S,s,E(i,t)))},clearSelection:function(){var e=this;e.selectable.clear(),e.trigger(a)},select:function(n){var a=this,r=a.selectable;return n=e(n),n.length?(r.options.multiple||(r.clear(),n=n.first()),r.value(n),t):r.value()},_destroyEditable:function(){var e=this;e.editable&&(e.editable.destroy(),delete e.editable)},_modelFromElement:function(e){var t=e.attr(n.attr("uid"));return this.dataSource.getByUid(t)},_closeEditable:function(e){var t,a,r=this,i=r.editable,l=r.template,o=!0;return i&&(e&&(o=i.end()),o&&(i.element.index()%2&&(l=r.altTemplate),t=r._modelFromElement(i.element),r._destroyEditable(),a=i.element.index(),i.element.replaceWith(l(t)),r.items().eq(a).attr(n.attr("uid"),t.uid))),o},edit:function(e){var t,a,r=this,i=r._modelFromElement(e),l=i.uid;r.cancel(),e=r.items().filter("["+n.attr("uid")+"="+l+"]"),a=e.index(),e.replaceWith(r.editTemplate(i)),t=r.items().eq(a).addClass(p).attr(n.attr("uid"),i.uid),r.editable=t.kendoEditable({model:i,clearContainer:!1,errorTemplate:!1}).data("kendoEditable"),r.trigger(v,{model:i,item:t})},save:function(){var e,t=this,n=t.editable;n&&(n=n.element,e=t._modelFromElement(n),!t.trigger(h,{model:e,item:n})&&t._closeEditable(!0)&&t.dataSource.sync())},remove:function(e){var t=this,n=t.dataSource,a=t._modelFromElement(e);t.trigger(b,{model:a,item:e})||(e.hide(),n.remove(a),n.sync())},add:function(){var e=this,t=e.dataSource,n=t.indexOf((t.view()||[])[0]);0>n&&(n=0),e.cancel(),t.insert(n,{}),e.edit(e.element.children().first())},cancel:function(){var e,t,n=this,a=n.dataSource;n.editable&&(e=n.editable.element,t=n._modelFromElement(e),n.trigger(r,{model:t,container:e})||(a.cancelChanges(t),n._closeEditable(!1)))},_crudHandlers:function(){var t=this,a=_+S;t.element.on(a,".k-edit-button",function(a){var r=e(this).closest("["+n.attr("uid")+"]");t.edit(r),a.preventDefault()}),t.element.on(a,".k-delete-button",function(a){var r=e(this).closest("["+n.attr("uid")+"]");t.remove(r),a.preventDefault()}),t.element.on(a,".k-update-button",function(e){t.save(),e.preventDefault()}),t.element.on(a,".k-cancel-button",function(e){t.cancel(),e.preventDefault()})},destroy:function(){var e=this;o.fn.destroy.call(e),e._unbindDataSource(),e._destroyEditable(),e.element.off(S),e.pager&&e.pager.destroy(),e.selectable&&e.selectable.destroy(),n.destroy(e.element)}});n.ui.plugin(T)}(window.kendo.jQuery)})}("function"==typeof define&&define.amd?define:function(e,t){return t()});