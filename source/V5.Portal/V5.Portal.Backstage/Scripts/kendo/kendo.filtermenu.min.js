/*
* Kendo UI Complete v2013.2.918 (http://kendoui.com)
* Copyright 2013 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-complete-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
!function(define){return define(["./kendo.datepicker.min","./kendo.numerictextbox.min","./kendo.dropdownlist.min"],function(){!function(e){function t(r,l){r.filters&&(r.filters=e.grep(r.filters,function(e){return t(e,l),e.filters?e.filters.length:e.field!=l}))}function r(e){var t,r,l,i,n,s;if(e&&e.length)for(s=[],t=0,r=e.length;r>t;t++)l=e[t],n=l.text||l.value||l,i=null==l.value?l.text||l:l.value,s[t]={text:n,value:i};return s}function l(t,r){return e.grep(t,function(t){return t.filters?(t.filters=e.grep(t.filters,function(e){return e.field!=r}),t.filters.length):t.field!=r})}var i=window.kendo,n=i.ui,s=e.proxy,a="kendoPopup",o="init",d=".kendoFilterMenu",f="Is equal to",u="Is not equal to",c={number:"numerictextbox",date:"datepicker"},p=e.isFunction,v=n.Widget,m='<div><div class="k-filter-help-text">#=messages.info#</div><label><input type="radio" data-#=ns#bind="checked: filters[0].value" value="true" name="filters[0].value"/>#=messages.isTrue#</label><label><input type="radio" data-#=ns#bind="checked: filters[0].value" value="false" name="filters[0].value"/>#=messages.isFalse#</label><div><button type="submit" class="k-button">#=messages.filter#</button><button type="reset" class="k-button">#=messages.clear#</button></div></div>',g='<div><div class="k-filter-help-text">#=messages.info#</div><select data-#=ns#bind="value: filters[0].operator" data-#=ns#role="dropdownlist">#for(var op in operators){#<option value="#=op#">#=operators[op]#</option>#}#</select>#if(values){#<select data-#=ns#bind="value:filters[0].value" data-#=ns#text-field="text" data-#=ns#value-field="value" data-#=ns#source=\'#=kendo.stringify(values).replace(/\'/g,"&\\#39;")#\' data-#=ns#role="dropdownlist" data-#=ns#option-label="#=messages.selectValue#"></select>#}else{#<input data-#=ns#bind="value:filters[0].value" class="k-textbox" type="text" #=role ? "data-" + ns + "role=\'" + role + "\'" : ""# />#}##if(extra){#<select class="k-filter-and" data-#=ns#bind="value: logic" data-#=ns#role="dropdownlist"><option value="and">#=messages.and#</option><option value="or">#=messages.or#</option></select><select data-#=ns#bind="value: filters[1].operator" data-#=ns#role="dropdownlist">#for(var op in operators){#<option value="#=op#">#=operators[op]#</option>#}#</select>#if(values){#<select data-#=ns#bind="value:filters[1].value" data-#=ns#text-field="text" data-#=ns#value-field="value" data-#=ns#source=\'#=kendo.stringify(values).replace(/\'/g,"&\\#39;")#\' data-#=ns#role="dropdownlist" data-#=ns#option-label="#=messages.selectValue#"></select>#}else{#<input data-#=ns#bind="value: filters[1].value" class="k-textbox" type="text" #=role ? "data-" + ns + "role=\'" + role + "\'" : ""#/>#}##}#<div><button type="submit" class="k-button">#=messages.filter#</button><button type="reset" class="k-button">#=messages.clear#</button></div></div>',h=v.extend({init:function(t,r){var l,n,a,o,f=this,u="string";v.fn.init.call(f,t,r),l=f.operators=r.operators||{},t=f.element,r=f.options,r.appendToElement||(a=t.addClass("k-filterable").find(".k-grid-filter"),a[0]||(a=t.prepend('<a class="k-grid-filter" href="#"><span class="k-icon k-filter"/></a>').find(".k-grid-filter")),a.attr("tabindex",-1).on("click"+d,s(f._click,f))),f.link=a||e(),f.dataSource=r.dataSource,f.field=r.field||t.attr(i.attr("field")),f.model=f.dataSource.reader.model,f._parse=function(e){return e+""},f.model&&f.model.fields&&(o=f.model.fields[f.field],o&&(u=o.type||"string",o.parse&&(f._parse=s(o.parse,o)))),r.values&&(u="enums"),f.type=u,l=l[u]||r.operators[u];for(n in l)break;f._defaultFilter=function(){return{field:f.field,operator:n||"eq",value:""}},f._refreshHandler=s(f.refresh,f),f.dataSource.bind("change",f._refreshHandler),r.appendToElement?f._init():f.refresh()},_init:function(){var t,l=this,n=l.options,f=l.operators||{},u=n.ui,v=p(u),h=l.type;f=f[h]||n.operators[h],v||(t=u||c[h]),l.form=e('<form class="k-filter-menu k-secondary"/>').html(i.template("boolean"===h?m:g)({field:l.field,format:n.format,ns:i.ns,messages:n.messages,extra:n.extra,operators:f,type:h,role:t,values:r(n.values)})).on("keydown"+d,s(l._keydown,l)).on("submit"+d,s(l._submit,l)).on("reset"+d,s(l._reset,l)),n.appendToElement?(l.element.append(l.form),l.popup=l.element.closest(".k-popup").data(a)):l.popup=l.form[a]({anchor:l.link,open:s(l._open,l),activate:s(l._activate,l),close:l.options.closeCallback}).data(a),v&&l.form.find(".k-textbox").removeClass("k-textbox").each(function(){u(e(this))}),l.form.find("["+i.attr("role")+"=numerictextbox]").removeClass("k-textbox").end().find("["+i.attr("role")+"=datetimepicker]").removeClass("k-textbox").end().find("["+i.attr("role")+"=timepicker]").removeClass("k-textbox").end().find("["+i.attr("role")+"=datepicker]").removeClass("k-textbox"),l.refresh(),l.trigger(o,{field:l.field,container:l.form})},refresh:function(){var e=this,t=e.dataSource.filter()||{filters:[],logic:"and"};e.filterModel=i.observable({logic:"and",filters:[e._defaultFilter(),e._defaultFilter()]}),e.form&&i.bind(e.form.children().first(),e.filterModel),e._bind(t)?e.link.addClass("k-state-active"):e.link.removeClass("k-state-active")},destroy:function(){var e=this;v.fn.destroy.call(e),e.form&&(i.unbind(e.form),i.destroy(e.form),e.form.unbind(d),e.popup.destroy()),e.link.unbind(d),e._refreshHandler&&e.dataSource.unbind("change",e._refreshHandler)},_bind:function(e){var t,r,l,i,n=this,s=e.filters,a=!1,o=0,d=n.filterModel;for(t=0,r=s.length;r>t;t++)i=s[t],i.field==n.field?(d.set("logic",e.logic),l=d.filters[o],l||(d.filters.push({field:n.field}),l=d.filters[o]),l.set("value",n._parse(i.value)),l.set("operator",i.operator),o++,a=!0):i.filters&&(a=a||n._bind(i));return a},_merge:function(r){var l,i,n,s=this,a=r.logic||"and",o=r.filters,d=s.dataSource.filter()||{filters:[],logic:"and"};for(t(d,s.field),o=e.grep(o,function(e){return""!==e.value&&null!=e.value}),i=0,n=o.length;n>i;i++)l=o[i],l.value=s._parse(l.value);return o.length&&(d.filters.length?(r.filters=o,"and"!==d.logic&&(d.filters=[{logic:d.logic,filters:d.filters}],d.logic="and"),o.length>1?d.filters.push(r):d.filters.push(o[0])):(d.filters=o,d.logic=a)),d},filter:function(e){e=this._merge(e),e.filters.length&&this.dataSource.filter(e)},clear:function(){var t=this,r=t.dataSource.filter()||{filters:[]};r.filters=e.grep(r.filters,function(e){return e.filters?(e.filters=l(e.filters,t.field),e.filters.length):e.field!=t.field}),r.filters.length||(r=null),t.dataSource.filter(r)},_submit:function(e){var t=this;e.preventDefault(),t.filter(t.filterModel.toJSON()),t.popup.close()},_reset:function(){this.clear(),this.popup.close()},_click:function(e){e.preventDefault(),e.stopPropagation(),this.popup||this._init(),this.popup.toggle()},_open:function(){var t;e(".k-filter-menu").not(this.form).each(function(){t=e(this).data(a),t&&t.close()})},_activate:function(){this.form.find(":focusable:first").focus()},_keydown:function(e){e.keyCode==i.keys.ESC&&this.popup.close()},events:[o],options:{name:"FilterMenu",extra:!0,appendToElement:!1,type:"string",operators:{string:{eq:f,neq:u,startswith:"Starts with",contains:"Contains",doesnotcontain:"Does not contain",endswith:"Ends with"},number:{eq:f,neq:u,gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"},date:{eq:f,neq:u,gte:"Is after or equal to",gt:"Is after",lte:"Is before or equal to",lt:"Is before"},enums:{eq:f,neq:u}},messages:{info:"Show items with value that:",isTrue:"is true",isFalse:"is false",filter:"Filter",clear:"Clear",and:"And",or:"Or",selectValue:"-Select value-"}}});n.plugin(h)}(window.kendo.jQuery)})}("function"==typeof define&&define.amd?define:function(e,t){return t()});